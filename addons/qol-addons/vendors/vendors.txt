// Vendor System
// Author: RO-Journey Team
// Version: 1.0
// Commands for viewing vendors and buyers lists

-	script	VendorCommands	-1,{
OnInit:
    bindatcmd("ws", strnpcinfo(3) + "::OnWS", 0, 99);
    bindatcmd("wb", strnpcinfo(3) + "::OnWB", 0, 99);
    end;
    
OnWS:
    mes "[Who Sell]";
    mes "Enter the item ID you want to search for:";
    next;
    input @item_id;
    
    if (@item_id <= 0) {
        mes "[Who Sell]";
        mes "Invalid item ID.";
        close;
    }
    
    // Get list of vendors selling this item
    query_sql("SELECT char_id, char_name, price FROM vendings WHERE item_id = " + @item_id, @char_id, @char_name, @price);
    
    if (getarraysize(@char_id) == 0) {
        mes "[Who Sell]";
        mes "No vendors found selling this item.";
        close;
    }
    
    mes "[Who Sell]";
    mes "Vendors selling item ID " + @item_id + ":";
    mes "----------------------------------------";
    
    for (.@i = 0; .@i < getarraysize(@char_id); .@i++) {
        mes "Vendor: " + @char_name[.@i];
        mes "Price: " + @price[.@i] + " zeny";
        mes "----------------------------------------";
    }
    close;
    
OnWB:
    mes "[Who Buy]";
    mes "Enter the item ID you want to search for:";
    next;
    input @item_id;
    
    if (@item_id <= 0) {
        mes "[Who Buy]";
        mes "Invalid item ID.";
        close;
    }
    
    // Get list of buyers for this item
    query_sql("SELECT char_id, char_name, price FROM buyingstores WHERE item_id = " + @item_id, @char_id, @char_name, @price);
    
    if (getarraysize(@char_id) == 0) {
        mes "[Who Buy]";
        mes "No buyers found for this item.";
        close;
    }
    
    mes "[Who Buy]";
    mes "Buyers for item ID " + @item_id + ":";
    mes "----------------------------------------";
    
    for (.@i = 0; .@i < getarraysize(@char_id); .@i++) {
        mes "Buyer: " + @char_name[.@i];
        mes "Price: " + @price[.@i] + " zeny";
        mes "----------------------------------------";
    }
    close;
} 